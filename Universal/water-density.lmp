units real
variable Otype index 1
variable Htype index 2
variable dz index 0.1
variable nEvery index 50000
variable outFreq index 250
variable nRepeat equal floor(v_nStep/v_outFreq)

variable first index 0
variable last index 50000
variable DATADIR index ./
variable label index test

atom_style full
pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-3
bond_style harmonic 
angle_style harmonic
improper_style harmonic

read_data ${datafile} 


group OXYGENS type ${Otype}
group HYDROGENS type ${Htype}
group WATERS union OXYGENS HYDROGENS

compute O_chunk OXYGENS chunk/atom bin/1d z center ${dz}
compute H_chunk HYDROGENS chunk/atom bin/1d z center ${dz}
compute all_chunk WATERS chunk/atom bin/1d z center ${dz}

fix rho_O OXYGENS ave/chunk ${outFreq} ${nRepeat} ${nStep} O_chunk density/mass &
    file ${DATADIR}O.rho.eq.${label}.out
fix rho_H HYDROGENS ave/chunk ${outFreq} ${nRepeat} ${nStep} H_chunk density/mass &
    file ${DATADIR}H.rho.eq.${label}.out 
fix rho_T WATERS ave/chunk ${outFreq} ${nRepeat} ${nStep} all_chunk density/mass &
    file ${DATADIR}rho.eq.${label}.out

rerun ${trajfile} first ${first} last ${last} dump x y z ix iy iz