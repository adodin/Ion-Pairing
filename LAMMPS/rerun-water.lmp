units real
variable Otype index 1
variable Htype index 2
variable dz index 1.0
variable trajEvery index 100
variable outFreq index 10000
variable nEvery index ${trajEvery}
variable nRepeat equal floor(v_outFreq/v_nEvery)
#variable nRepeat index 2

variable first index 0
variable last index 50000
variable DATADIR index ./
variable label index test_number

atom_style full
pair_style lj/cut/coul/long 12.0
kspace_style pppm 1e-3
bond_style harmonic 
angle_style harmonic
improper_style harmonic
dihedral_style fourier

read_data ${datafile} 

pair_coeff * * 0 0


group OXYGENS type ${Otype}
group HYDROGENS type ${Htype}
group WATERS union OXYGENS HYDROGENS

compute O_chunk OXYGENS chunk/atom bin/1d z center ${dz}
compute H_chunk HYDROGENS chunk/atom bin/1d z center ${dz}
compute all_chunk WATERS chunk/atom bin/1d z center ${dz}

fix rho_O OXYGENS ave/chunk ${nEvery} ${nRepeat} ${outFreq} O_chunk density/number &
    file ${DATADIR}O.rho.eq.${label}.out
fix rho_H HYDROGENS ave/chunk ${nEvery} ${nRepeat} ${outFreq} H_chunk density/number &
    file ${DATADIR}H.rho.eq.${label}.out 
fix rho_T WATERS ave/chunk ${nEvery} ${nRepeat} ${outFreq} all_chunk density/number &
    file ${DATADIR}rho.eq.${label}.out

rerun ${trajfile} first ${first} last ${last} dump x y z ix iy iz